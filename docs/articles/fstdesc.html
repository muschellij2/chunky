<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Why use the fst package • fstnii</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Why use the fst package">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fstnii</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/fstdesc.html">Why use the fst package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/muschellij2/fstnii">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Why use the fst package</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/muschellij2/fstnii/blob/master/vignettes/fstdesc.Rmd"><code>vignettes/fstdesc.Rmd</code></a></small>
      <div class="hidden name"><code>fstdesc.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(fstnii)</a></code></pre></div>
<p>The <a href="https://www.fstpackage.org/"><code>fst</code> package</a> provides a nice interface for fast access of <code>data.frame</code>s. One of the crucial uses of <code>fst</code> is that it can perform <a href="https://en.wikipedia.org/wiki/Random_access">random access</a> on rows of a data set without reading the data into <code>R</code>.</p>
<div id="use-case" class="section level1">
<h1 class="hasAnchor">
<a href="#use-case" class="anchor"></a>Use case</h1>
<p>The use case we have for this package is that you have a number of aligned NIfTI images that you’d want to be able to subset without reading in the entire data. The main functions is <code>nii2fst</code>, which takes in filenames of NIfTI images and vectorizes them, makes them into <code>data.frame</code>s, then reads them into a <code>fst_table</code>. The <code>nii2fst</code> function works with 3D and 4D images.</p>
<div id="d-example" class="section level2">
<h2 class="hasAnchor">
<a href="#d-example" class="anchor"></a>3D Example</h2>
<p>Below we make a series of images, with the same dimensions for each image and get back a vector of filenames.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">run =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/ns-load">requireNamespace</a></span>(<span class="st">"oro.nifti"</span>, <span class="dt">quietly =</span> <span class="ot">TRUE</span>) <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="st">    </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/ns-load">requireNamespace</a></span>(<span class="st">"neurobase"</span>, <span class="dt">quietly =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="cf">if</span> (run) {</a>
<a class="sourceLine" id="cb2-4" title="4">  files_3d =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">sapply</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb2-5" title="5">    arr =<span class="st"> </span>oro.nifti<span class="op">::</span><span class="kw">nifti</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/array">array</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">50</span><span class="op">^</span><span class="dv">3</span>), <span class="dt">dim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">50</span>, <span class="dv">3</span>)))</a>
<a class="sourceLine" id="cb2-6" title="6">    tfile =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/tempfile">tempfile</a></span>()</a>
<a class="sourceLine" id="cb2-7" title="7">    neurobase<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/neurobase/topics/writeNIfTI2">writenii</a></span>(arr, tfile)</a>
<a class="sourceLine" id="cb2-8" title="8">    tfile</a>
<a class="sourceLine" id="cb2-9" title="9">  })</a>
<a class="sourceLine" id="cb2-10" title="10">}</a></code></pre></div>
<p>Let’s run <code>nii2fst</code> on just one image:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="cf">if</span> (run) {</a>
<a class="sourceLine" id="cb3-2" title="2">  res =<span class="st"> </span><span class="kw"><a href="../reference/nii2fst.html">nii2fst</a></span>(files_3d[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb3-3" title="3">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(res<span class="op">$</span>indices)</a>
<a class="sourceLine" id="cb3-4" title="4">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(res<span class="op">$</span>data)</a>
<a class="sourceLine" id="cb3-5" title="5">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/class">class</a></span>(res))</a>
<a class="sourceLine" id="cb3-6" title="6">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(res))</a>
<a class="sourceLine" id="cb3-7" title="7">}</a>
<a class="sourceLine" id="cb3-8" title="8"><span class="op">&lt;</span>fst file<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="dv">125000</span> rows, <span class="dv">3</span> <span class="kw">columns</span> (file16f14131f7e79.fst)</a>
<a class="sourceLine" id="cb3-10" title="10"></a>
<a class="sourceLine" id="cb3-11" title="11">[<span class="dv">38</span>;<span class="dv">5</span>;248m      [39m      dim1      dim2      dim3</a>
<a class="sourceLine" id="cb3-12" title="12">[3m[<span class="dv">38</span>;<span class="dv">5</span>;248m       <span class="op">&lt;</span>integer<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>integer<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>integer<span class="op">&gt;</span>[39m[23m</a>
<a class="sourceLine" id="cb3-13" title="13">[<span class="dv">38</span>;<span class="dv">5</span>;248m1     [39m         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span></a>
<a class="sourceLine" id="cb3-14" title="14">[<span class="dv">38</span>;<span class="dv">5</span>;248m2     [39m         <span class="dv">2</span>         <span class="dv">1</span>         <span class="dv">1</span></a>
<a class="sourceLine" id="cb3-15" title="15">[<span class="dv">38</span>;<span class="dv">5</span>;248m3     [39m         <span class="dv">3</span>         <span class="dv">1</span>         <span class="dv">1</span></a>
<a class="sourceLine" id="cb3-16" title="16">[<span class="dv">38</span>;<span class="dv">5</span>;248m4     [39m         <span class="dv">4</span>         <span class="dv">1</span>         <span class="dv">1</span></a>
<a class="sourceLine" id="cb3-17" title="17">[<span class="dv">38</span>;<span class="dv">5</span>;248m5     [39m         <span class="dv">5</span>         <span class="dv">1</span>         <span class="dv">1</span></a>
<a class="sourceLine" id="cb3-18" title="18">[<span class="dv">38</span>;<span class="dv">5</span>;248m<span class="op">--</span><span class="st">            </span><span class="op">--</span><span class="st">        </span><span class="op">--</span><span class="st">        </span><span class="op">--</span>[39m</a>
<a class="sourceLine" id="cb3-19" title="19">[<span class="dv">38</span>;<span class="dv">5</span>;248m124996[39m        <span class="dv">46</span>        <span class="dv">50</span>        <span class="dv">50</span></a>
<a class="sourceLine" id="cb3-20" title="20">[<span class="dv">38</span>;<span class="dv">5</span>;248m124997[39m        <span class="dv">47</span>        <span class="dv">50</span>        <span class="dv">50</span></a>
<a class="sourceLine" id="cb3-21" title="21">[<span class="dv">38</span>;<span class="dv">5</span>;248m124998[39m        <span class="dv">48</span>        <span class="dv">50</span>        <span class="dv">50</span></a>
<a class="sourceLine" id="cb3-22" title="22">[<span class="dv">38</span>;<span class="dv">5</span>;248m124999[39m        <span class="dv">49</span>        <span class="dv">50</span>        <span class="dv">50</span></a>
<a class="sourceLine" id="cb3-23" title="23">[<span class="dv">38</span>;<span class="dv">5</span>;248m125000[39m        <span class="dv">50</span>        <span class="dv">50</span>        <span class="dv">50</span></a>
<a class="sourceLine" id="cb3-24" title="24">[<span class="dv">1</span>] <span class="st">"/var/folders/1s/wrtqcpxn685_zk570bnx9_rr0000gr/T//Rtmps1Smqo/file16f1478a843bd.fst"</span></a>
<a class="sourceLine" id="cb3-25" title="25">[<span class="dv">1</span>] <span class="st">"niifst_table"</span></a>
<a class="sourceLine" id="cb3-26" title="26">[<span class="dv">1</span>] <span class="st">"indices"</span> <span class="st">"data"</span>   </a>
<a class="sourceLine" id="cb3-27" title="27"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">getOption</a></span>(<span class="st">"crayon.enabled"</span>)</a>
<a class="sourceLine" id="cb3-28" title="28"><span class="ot">NULL</span></a></code></pre></div>
<p>We see that the output is a <code>niifst_table</code> which has 2 elements, a slot of <code>indices</code>, which is a Vx3 <code>data.frame</code> of the x,y,z coordinates of the image. This can be used to subset the <code>data</code> element so that you can read in just a subset of the data. We did not read in the data, however, as the default is <code>read_in = FALSE</code>. Let’s run the same thing but read in the data.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="cf">if</span> (run) {</a>
<a class="sourceLine" id="cb4-2" title="2">  res =<span class="st"> </span><span class="kw"><a href="../reference/nii2fst.html">nii2fst</a></span>(files_3d[<span class="dv">1</span>], <span class="dt">read_in =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb4-3" title="3">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(res<span class="op">$</span>indices)</a>
<a class="sourceLine" id="cb4-4" title="4">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(res<span class="op">$</span>data)</a>
<a class="sourceLine" id="cb4-5" title="5">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/class">class</a></span>(res))</a>
<a class="sourceLine" id="cb4-6" title="6">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(res))</a>
<a class="sourceLine" id="cb4-7" title="7">}</a>
<a class="sourceLine" id="cb4-8" title="8"><span class="op">&lt;</span>fst file<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="dv">125000</span> rows, <span class="dv">3</span> <span class="kw">columns</span> (file16f14359d9045.fst)</a>
<a class="sourceLine" id="cb4-10" title="10"></a>
<a class="sourceLine" id="cb4-11" title="11">[<span class="dv">38</span>;<span class="dv">5</span>;248m      [39m      dim1      dim2      dim3</a>
<a class="sourceLine" id="cb4-12" title="12">[3m[<span class="dv">38</span>;<span class="dv">5</span>;248m       <span class="op">&lt;</span>integer<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>integer<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>integer<span class="op">&gt;</span>[39m[23m</a>
<a class="sourceLine" id="cb4-13" title="13">[<span class="dv">38</span>;<span class="dv">5</span>;248m1     [39m         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span></a>
<a class="sourceLine" id="cb4-14" title="14">[<span class="dv">38</span>;<span class="dv">5</span>;248m2     [39m         <span class="dv">2</span>         <span class="dv">1</span>         <span class="dv">1</span></a>
<a class="sourceLine" id="cb4-15" title="15">[<span class="dv">38</span>;<span class="dv">5</span>;248m3     [39m         <span class="dv">3</span>         <span class="dv">1</span>         <span class="dv">1</span></a>
<a class="sourceLine" id="cb4-16" title="16">[<span class="dv">38</span>;<span class="dv">5</span>;248m4     [39m         <span class="dv">4</span>         <span class="dv">1</span>         <span class="dv">1</span></a>
<a class="sourceLine" id="cb4-17" title="17">[<span class="dv">38</span>;<span class="dv">5</span>;248m5     [39m         <span class="dv">5</span>         <span class="dv">1</span>         <span class="dv">1</span></a>
<a class="sourceLine" id="cb4-18" title="18">[<span class="dv">38</span>;<span class="dv">5</span>;248m<span class="op">--</span><span class="st">            </span><span class="op">--</span><span class="st">        </span><span class="op">--</span><span class="st">        </span><span class="op">--</span>[39m</a>
<a class="sourceLine" id="cb4-19" title="19">[<span class="dv">38</span>;<span class="dv">5</span>;248m124996[39m        <span class="dv">46</span>        <span class="dv">50</span>        <span class="dv">50</span></a>
<a class="sourceLine" id="cb4-20" title="20">[<span class="dv">38</span>;<span class="dv">5</span>;248m124997[39m        <span class="dv">47</span>        <span class="dv">50</span>        <span class="dv">50</span></a>
<a class="sourceLine" id="cb4-21" title="21">[<span class="dv">38</span>;<span class="dv">5</span>;248m124998[39m        <span class="dv">48</span>        <span class="dv">50</span>        <span class="dv">50</span></a>
<a class="sourceLine" id="cb4-22" title="22">[<span class="dv">38</span>;<span class="dv">5</span>;248m124999[39m        <span class="dv">49</span>        <span class="dv">50</span>        <span class="dv">50</span></a>
<a class="sourceLine" id="cb4-23" title="23">[<span class="dv">38</span>;<span class="dv">5</span>;248m125000[39m        <span class="dv">50</span>        <span class="dv">50</span>        <span class="dv">50</span></a>
<a class="sourceLine" id="cb4-24" title="24">[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb4-25" title="25"><span class="op">&lt;</span>fst file<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb4-26" title="26"><span class="dv">125000</span> rows, <span class="dv">1</span> <span class="kw">columns</span> (file16f147b6abd82.fst)</a>
<a class="sourceLine" id="cb4-27" title="27"></a>
<a class="sourceLine" id="cb4-28" title="28">[<span class="dv">38</span>;<span class="dv">5</span>;248m      [39m        img</a>
<a class="sourceLine" id="cb4-29" title="29">[3m[<span class="dv">38</span>;<span class="dv">5</span>;248m         <span class="op">&lt;</span>double<span class="op">&gt;</span>[39m[23m</a>
<a class="sourceLine" id="cb4-30" title="30">[<span class="dv">38</span>;<span class="dv">5</span>;248m1     [39m <span class="fl">-0.4171536</span></a>
<a class="sourceLine" id="cb4-31" title="31">[<span class="dv">38</span>;<span class="dv">5</span>;248m2     [39m <span class="fl">-1.2925273</span></a>
<a class="sourceLine" id="cb4-32" title="32">[<span class="dv">38</span>;<span class="dv">5</span>;248m3     [39m <span class="fl">-2.6025012</span></a>
<a class="sourceLine" id="cb4-33" title="33">[<span class="dv">38</span>;<span class="dv">5</span>;248m4     [39m  <span class="fl">0.5790419</span></a>
<a class="sourceLine" id="cb4-34" title="34">[<span class="dv">38</span>;<span class="dv">5</span>;248m5     [39m <span class="fl">-0.5731872</span></a>
<a class="sourceLine" id="cb4-35" title="35">[<span class="dv">38</span>;<span class="dv">5</span>;248m<span class="op">--</span><span class="st">             </span><span class="op">--</span>[39m</a>
<a class="sourceLine" id="cb4-36" title="36">[<span class="dv">38</span>;<span class="dv">5</span>;248m124996[39m <span class="fl">-0.1690231</span></a>
<a class="sourceLine" id="cb4-37" title="37">[<span class="dv">38</span>;<span class="dv">5</span>;248m124997[39m  <span class="fl">0.2409165</span></a>
<a class="sourceLine" id="cb4-38" title="38">[<span class="dv">38</span>;<span class="dv">5</span>;248m124998[39m <span class="fl">-0.3414271</span></a>
<a class="sourceLine" id="cb4-39" title="39">[<span class="dv">38</span>;<span class="dv">5</span>;248m124999[39m <span class="fl">-0.1589314</span></a>
<a class="sourceLine" id="cb4-40" title="40">[<span class="dv">38</span>;<span class="dv">5</span>;248m125000[39m  <span class="fl">0.1560319</span></a>
<a class="sourceLine" id="cb4-41" title="41"></a>
<a class="sourceLine" id="cb4-42" title="42">[<span class="dv">1</span>] <span class="st">"niifst_table"</span></a>
<a class="sourceLine" id="cb4-43" title="43">[<span class="dv">1</span>] <span class="st">"indices"</span> <span class="st">"data"</span>   </a>
<a class="sourceLine" id="cb4-44" title="44"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">getOption</a></span>(<span class="st">"crayon.enabled"</span>)</a>
<a class="sourceLine" id="cb4-45" title="45"><span class="ot">NULL</span></a></code></pre></div>
<div id="reading-in-all-the-files" class="section level3">
<h3 class="hasAnchor">
<a href="#reading-in-all-the-files" class="anchor"></a>Reading in all the files</h3>
<p>We showed that we can read in one of the files. Now, let’s read in all the files. This code checks to make sure the dimensions of the images are the same (but no orientation or other checks):</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="cf">if</span> (run) {</a>
<a class="sourceLine" id="cb5-2" title="2">  res =<span class="st"> </span><span class="kw"><a href="../reference/nii2fst.html">nii2fst</a></span>(files_3d, <span class="dt">read_in =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb5-3" title="3">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(res<span class="op">$</span>indices)</a>
<a class="sourceLine" id="cb5-4" title="4">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(res<span class="op">$</span>data))</a>
<a class="sourceLine" id="cb5-5" title="5">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/dim">dim</a></span>(res<span class="op">$</span>data[[<span class="dv">1</span>]]))</a>
<a class="sourceLine" id="cb5-6" title="6">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/class">class</a></span>(res))</a>
<a class="sourceLine" id="cb5-7" title="7">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(res))</a>
<a class="sourceLine" id="cb5-8" title="8">}</a>
<a class="sourceLine" id="cb5-9" title="9"><span class="op">&lt;</span>fst file<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="dv">125000</span> rows, <span class="dv">3</span> <span class="kw">columns</span> (file16f147953c25b.fst)</a>
<a class="sourceLine" id="cb5-11" title="11"></a>
<a class="sourceLine" id="cb5-12" title="12">[<span class="dv">38</span>;<span class="dv">5</span>;248m      [39m      dim1      dim2      dim3</a>
<a class="sourceLine" id="cb5-13" title="13">[3m[<span class="dv">38</span>;<span class="dv">5</span>;248m       <span class="op">&lt;</span>integer<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>integer<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>integer<span class="op">&gt;</span>[39m[23m</a>
<a class="sourceLine" id="cb5-14" title="14">[<span class="dv">38</span>;<span class="dv">5</span>;248m1     [39m         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span></a>
<a class="sourceLine" id="cb5-15" title="15">[<span class="dv">38</span>;<span class="dv">5</span>;248m2     [39m         <span class="dv">2</span>         <span class="dv">1</span>         <span class="dv">1</span></a>
<a class="sourceLine" id="cb5-16" title="16">[<span class="dv">38</span>;<span class="dv">5</span>;248m3     [39m         <span class="dv">3</span>         <span class="dv">1</span>         <span class="dv">1</span></a>
<a class="sourceLine" id="cb5-17" title="17">[<span class="dv">38</span>;<span class="dv">5</span>;248m4     [39m         <span class="dv">4</span>         <span class="dv">1</span>         <span class="dv">1</span></a>
<a class="sourceLine" id="cb5-18" title="18">[<span class="dv">38</span>;<span class="dv">5</span>;248m5     [39m         <span class="dv">5</span>         <span class="dv">1</span>         <span class="dv">1</span></a>
<a class="sourceLine" id="cb5-19" title="19">[<span class="dv">38</span>;<span class="dv">5</span>;248m<span class="op">--</span><span class="st">            </span><span class="op">--</span><span class="st">        </span><span class="op">--</span><span class="st">        </span><span class="op">--</span>[39m</a>
<a class="sourceLine" id="cb5-20" title="20">[<span class="dv">38</span>;<span class="dv">5</span>;248m124996[39m        <span class="dv">46</span>        <span class="dv">50</span>        <span class="dv">50</span></a>
<a class="sourceLine" id="cb5-21" title="21">[<span class="dv">38</span>;<span class="dv">5</span>;248m124997[39m        <span class="dv">47</span>        <span class="dv">50</span>        <span class="dv">50</span></a>
<a class="sourceLine" id="cb5-22" title="22">[<span class="dv">38</span>;<span class="dv">5</span>;248m124998[39m        <span class="dv">48</span>        <span class="dv">50</span>        <span class="dv">50</span></a>
<a class="sourceLine" id="cb5-23" title="23">[<span class="dv">38</span>;<span class="dv">5</span>;248m124999[39m        <span class="dv">49</span>        <span class="dv">50</span>        <span class="dv">50</span></a>
<a class="sourceLine" id="cb5-24" title="24">[<span class="dv">38</span>;<span class="dv">5</span>;248m125000[39m        <span class="dv">50</span>        <span class="dv">50</span>        <span class="dv">50</span></a>
<a class="sourceLine" id="cb5-25" title="25">[<span class="dv">1</span>] <span class="dv">10</span></a>
<a class="sourceLine" id="cb5-26" title="26">[<span class="dv">1</span>] <span class="dv">125000</span>      <span class="dv">1</span></a>
<a class="sourceLine" id="cb5-27" title="27">[<span class="dv">1</span>] <span class="st">"niifst_table"</span></a>
<a class="sourceLine" id="cb5-28" title="28">[<span class="dv">1</span>] <span class="st">"indices"</span> <span class="st">"data"</span>   </a></code></pre></div>
</div>
<div id="subsetting-the-data" class="section level3">
<h3 class="hasAnchor">
<a href="#subsetting-the-data" class="anchor"></a>Subsetting the data</h3>
<p>Let’s get some rows that we want from the data. Here, we will subset based on <code>indices</code>, but apply that subsetting to <code>data</code>. Note, as per <a href="https://github.com/fstpackage/fst/issues/108" class="uri">https://github.com/fstpackage/fst/issues/108</a>, there is a <code>dplyr</code> interface that may be in the works, but right now I’d recommend using base bracket subsetting.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="cf">if</span> (run) {</a>
<a class="sourceLine" id="cb6-2" title="2">  index =<span class="st"> </span>res<span class="op">$</span>indices</a>
<a class="sourceLine" id="cb6-3" title="3">  index =<span class="st"> </span>index<span class="op">$</span>dim1 <span class="op">==</span><span class="st"> </span><span class="dv">14</span> <span class="op">&amp;</span><span class="st"> </span>(index<span class="op">$</span>dim2 <span class="op">&gt;</span><span class="st"> </span><span class="dv">10</span> <span class="op">&amp;</span><span class="st"> </span>index<span class="op">$</span>dim2 <span class="op">&lt;</span><span class="st"> </span><span class="dv">14</span>) <span class="op">&amp;</span><span class="st"> </span>(index<span class="op">$</span>dim3 <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span> <span class="op">&amp;</span><span class="st"> </span>index<span class="op">$</span>dim3 <span class="op">&lt;</span><span class="st"> </span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb6-4" title="4">  res<span class="op">$</span>data[[<span class="dv">1</span>]][index,]</a>
<a class="sourceLine" id="cb6-5" title="5">  mat =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">sapply</a></span>(res<span class="op">$</span>data, <span class="cf">function</span>(mat) mat[index, ]) </a>
<a class="sourceLine" id="cb6-6" title="6">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/dim">dim</a></span>(mat))</a>
<a class="sourceLine" id="cb6-7" title="7">}</a>
<a class="sourceLine" id="cb6-8" title="8">[<span class="dv">1</span>] <span class="dv">15</span> <span class="dv">10</span></a></code></pre></div>
</div>
</div>
<div id="d-example-1" class="section level2">
<h2 class="hasAnchor">
<a href="#d-example-1" class="anchor"></a>4D Example</h2>
<p>When the data are 4D, the data is reshaped so that each column is a different time point. Here we create the data again, but with 4 dimensions:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="cf">if</span> (<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/ns-load">requireNamespace</a></span>(<span class="st">"oro.nifti"</span>, <span class="dt">quietly =</span> <span class="ot">TRUE</span>) <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="st">    </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/ns-load">requireNamespace</a></span>(<span class="st">"neurobase"</span>, <span class="dt">quietly =</span> <span class="ot">TRUE</span>)) {  </a>
<a class="sourceLine" id="cb7-3" title="3">  files_4d =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">lapply</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb7-4" title="4">    arr =<span class="st"> </span>oro.nifti<span class="op">::</span><span class="kw">nifti</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/array">array</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">10</span><span class="op">^</span><span class="dv">4</span>), <span class="dt">dim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">10</span>, <span class="dv">4</span>)))</a>
<a class="sourceLine" id="cb7-5" title="5">    tfile =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/tempfile">tempfile</a></span>()</a>
<a class="sourceLine" id="cb7-6" title="6">    neurobase<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/neurobase/topics/writeNIfTI2">writenii</a></span>(arr, tfile)</a>
<a class="sourceLine" id="cb7-7" title="7">    tfile</a>
<a class="sourceLine" id="cb7-8" title="8">  })  </a>
<a class="sourceLine" id="cb7-9" title="9">}</a></code></pre></div>
<div id="reading-in-one-file" class="section level3">
<h3 class="hasAnchor">
<a href="#reading-in-one-file" class="anchor"></a>Reading in one file</h3>
<p>Here we will read in the 4D file and then show the corresponding result. Note, the data now has more than 1 column, where the number of columns coresponds to the number of time points:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="cf">if</span> (run) {</a>
<a class="sourceLine" id="cb8-2" title="2">  res =<span class="st"> </span><span class="kw"><a href="../reference/nii2fst.html">nii2fst</a></span>(files_4d[<span class="dv">1</span>], <span class="dt">read_in =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb8-3" title="3">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(res<span class="op">$</span>indices)</a>
<a class="sourceLine" id="cb8-4" title="4">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(res<span class="op">$</span>data)</a>
<a class="sourceLine" id="cb8-5" title="5">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/dim">dim</a></span>(res<span class="op">$</span>data))</a>
<a class="sourceLine" id="cb8-6" title="6">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/class">class</a></span>(res))</a>
<a class="sourceLine" id="cb8-7" title="7">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(res))</a>
<a class="sourceLine" id="cb8-8" title="8">}</a>
<a class="sourceLine" id="cb8-9" title="9"><span class="op">&lt;</span>fst file<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="dv">1000</span> rows, <span class="dv">3</span> <span class="kw">columns</span> (file16f14256c1d9e.fst)</a>
<a class="sourceLine" id="cb8-11" title="11"></a>
<a class="sourceLine" id="cb8-12" title="12">[<span class="dv">38</span>;<span class="dv">5</span>;248m    [39m      dim1      dim2      dim3</a>
<a class="sourceLine" id="cb8-13" title="13">[3m[<span class="dv">38</span>;<span class="dv">5</span>;248m     <span class="op">&lt;</span>integer<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>integer<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>integer<span class="op">&gt;</span>[39m[23m</a>
<a class="sourceLine" id="cb8-14" title="14">[<span class="dv">38</span>;<span class="dv">5</span>;248m1   [39m         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span></a>
<a class="sourceLine" id="cb8-15" title="15">[<span class="dv">38</span>;<span class="dv">5</span>;248m2   [39m         <span class="dv">2</span>         <span class="dv">1</span>         <span class="dv">1</span></a>
<a class="sourceLine" id="cb8-16" title="16">[<span class="dv">38</span>;<span class="dv">5</span>;248m3   [39m         <span class="dv">3</span>         <span class="dv">1</span>         <span class="dv">1</span></a>
<a class="sourceLine" id="cb8-17" title="17">[<span class="dv">38</span>;<span class="dv">5</span>;248m4   [39m         <span class="dv">4</span>         <span class="dv">1</span>         <span class="dv">1</span></a>
<a class="sourceLine" id="cb8-18" title="18">[<span class="dv">38</span>;<span class="dv">5</span>;248m5   [39m         <span class="dv">5</span>         <span class="dv">1</span>         <span class="dv">1</span></a>
<a class="sourceLine" id="cb8-19" title="19">[<span class="dv">38</span>;<span class="dv">5</span>;248m<span class="op">--</span><span class="st">          </span><span class="op">--</span><span class="st">        </span><span class="op">--</span><span class="st">        </span><span class="op">--</span>[39m</a>
<a class="sourceLine" id="cb8-20" title="20">[<span class="dv">38</span>;<span class="dv">5</span>;248m996 [39m         <span class="dv">6</span>        <span class="dv">10</span>        <span class="dv">10</span></a>
<a class="sourceLine" id="cb8-21" title="21">[<span class="dv">38</span>;<span class="dv">5</span>;248m997 [39m         <span class="dv">7</span>        <span class="dv">10</span>        <span class="dv">10</span></a>
<a class="sourceLine" id="cb8-22" title="22">[<span class="dv">38</span>;<span class="dv">5</span>;248m998 [39m         <span class="dv">8</span>        <span class="dv">10</span>        <span class="dv">10</span></a>
<a class="sourceLine" id="cb8-23" title="23">[<span class="dv">38</span>;<span class="dv">5</span>;248m999 [39m         <span class="dv">9</span>        <span class="dv">10</span>        <span class="dv">10</span></a>
<a class="sourceLine" id="cb8-24" title="24">[<span class="dv">38</span>;<span class="dv">5</span>;248m1000[39m        <span class="dv">10</span>        <span class="dv">10</span>        <span class="dv">10</span></a>
<a class="sourceLine" id="cb8-25" title="25">[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb8-26" title="26"><span class="op">&lt;</span>fst file<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb8-27" title="27"><span class="dv">1000</span> rows, <span class="dv">10</span> <span class="kw">columns</span> (file16f145d0c8343.fst)</a>
<a class="sourceLine" id="cb8-28" title="28"></a>
<a class="sourceLine" id="cb8-29" title="29">[<span class="dv">38</span>;<span class="dv">5</span>;248m    [39m      img_<span class="dv">1</span>      img_<span class="dv">2</span>      img_<span class="dv">3</span>      img_<span class="dv">4</span>       img_<span class="dv">5</span>      img_<span class="dv">6</span></a>
<a class="sourceLine" id="cb8-30" title="30">[3m[<span class="dv">38</span>;<span class="dv">5</span>;248m       <span class="op">&lt;</span>double<span class="op">&gt;</span><span class="st">   </span><span class="er">&lt;</span>double<span class="op">&gt;</span><span class="st">   </span><span class="er">&lt;</span>double<span class="op">&gt;</span><span class="st">   </span><span class="er">&lt;</span>double<span class="op">&gt;</span><span class="st">    </span><span class="er">&lt;</span>double<span class="op">&gt;</span><span class="st">   </span><span class="er">&lt;</span>double<span class="op">&gt;</span>[39m[23m</a>
<a class="sourceLine" id="cb8-31" title="31">[<span class="dv">38</span>;<span class="dv">5</span>;248m1   [39m  <span class="fl">0.9974881</span> <span class="fl">-0.7056409</span> <span class="fl">-0.7652879</span> <span class="fl">-0.5054365</span>  <span class="fl">0.21736006</span>  <span class="fl">1.2513336</span></a>
<a class="sourceLine" id="cb8-32" title="32">[<span class="dv">38</span>;<span class="dv">5</span>;248m2   [39m  <span class="fl">1.8975282</span>  <span class="fl">0.3554035</span>  <span class="fl">0.2568802</span>  <span class="fl">0.9095201</span>  <span class="fl">1.36359406</span>  <span class="fl">0.1302606</span></a>
<a class="sourceLine" id="cb8-33" title="33">[<span class="dv">38</span>;<span class="dv">5</span>;248m3   [39m <span class="fl">-1.4159421</span> <span class="fl">-1.7434931</span>  <span class="fl">2.1228013</span>  <span class="fl">0.3857232</span>  <span class="fl">0.42279884</span> <span class="fl">-0.7218316</span></a>
<a class="sourceLine" id="cb8-34" title="34">[<span class="dv">38</span>;<span class="dv">5</span>;248m4   [39m  <span class="fl">0.6926447</span> <span class="fl">-0.6144199</span>  <span class="fl">1.3425633</span> <span class="fl">-0.2175140</span> <span class="fl">-1.66476023</span>  <span class="fl">0.2488441</span></a>
<a class="sourceLine" id="cb8-35" title="35">[<span class="dv">38</span>;<span class="dv">5</span>;248m5   [39m <span class="fl">-0.7166958</span> <span class="fl">-2.7245185</span>  <span class="fl">1.0639397</span>  <span class="fl">0.3168603</span>  <span class="fl">0.38172582</span>  <span class="fl">0.8209634</span></a>
<a class="sourceLine" id="cb8-36" title="36">[<span class="dv">38</span>;<span class="dv">5</span>;248m<span class="op">--</span><span class="st">           </span><span class="op">--</span><span class="st">         </span><span class="op">--</span><span class="st">         </span><span class="op">--</span><span class="st">         </span><span class="op">--</span><span class="st">          </span><span class="op">--</span><span class="st">         </span><span class="op">--</span>[39m</a>
<a class="sourceLine" id="cb8-37" title="37">[<span class="dv">38</span>;<span class="dv">5</span>;248m996 [39m <span class="fl">-0.1437505</span>  <span class="fl">0.3547916</span> <span class="fl">-0.2687631</span>  <span class="fl">0.3573954</span> <span class="fl">-0.58773291</span> <span class="fl">-2.0393054</span></a>
<a class="sourceLine" id="cb8-38" title="38">[<span class="dv">38</span>;<span class="dv">5</span>;248m997 [39m <span class="fl">-1.5428584</span> <span class="fl">-0.7598377</span>  <span class="fl">0.1891519</span>  <span class="fl">2.0466564</span> <span class="fl">-0.06206889</span> <span class="fl">-1.1685519</span></a>
<a class="sourceLine" id="cb8-39" title="39">[<span class="dv">38</span>;<span class="dv">5</span>;248m998 [39m <span class="fl">-1.0892285</span>  <span class="fl">0.1179127</span> <span class="fl">-1.6859642</span>  <span class="fl">0.2947390</span>  <span class="fl">0.73369116</span> <span class="fl">-0.2162116</span></a>
<a class="sourceLine" id="cb8-40" title="40">[<span class="dv">38</span>;<span class="dv">5</span>;248m999 [39m  <span class="fl">0.5188811</span> <span class="fl">-1.4000460</span> <span class="fl">-0.4290603</span>  <span class="fl">0.1413003</span>  <span class="fl">0.54532528</span> <span class="fl">-1.0557288</span></a>
<a class="sourceLine" id="cb8-41" title="41">[<span class="dv">38</span>;<span class="dv">5</span>;248m1000[39m  <span class="fl">1.2291739</span>  <span class="fl">1.0389628</span>  <span class="fl">0.2226679</span>  <span class="fl">0.8031026</span> <span class="fl">-1.04920602</span> <span class="fl">-0.2570864</span></a>
<a class="sourceLine" id="cb8-42" title="42">[<span class="dv">38</span>;<span class="dv">5</span>;248m    [39m       img_<span class="dv">7</span>       img_<span class="dv">8</span>      img_<span class="dv">9</span>     img_<span class="dv">10</span></a>
<a class="sourceLine" id="cb8-43" title="43">[3m[<span class="dv">38</span>;<span class="dv">5</span>;248m        <span class="op">&lt;</span>double<span class="op">&gt;</span><span class="st">    </span><span class="er">&lt;</span>double<span class="op">&gt;</span><span class="st">   </span><span class="er">&lt;</span>double<span class="op">&gt;</span><span class="st">   </span><span class="er">&lt;</span>double<span class="op">&gt;</span>[39m[23m</a>
<a class="sourceLine" id="cb8-44" title="44">[<span class="dv">38</span>;<span class="dv">5</span>;248m1   [39m  <span class="fl">2.11038923</span>  <span class="fl">0.33995530</span> <span class="fl">-1.0308058</span>  <span class="fl">1.4010841</span></a>
<a class="sourceLine" id="cb8-45" title="45">[<span class="dv">38</span>;<span class="dv">5</span>;248m2   [39m <span class="fl">-0.06431939</span>  <span class="fl">0.39806208</span> <span class="fl">-1.3672071</span> <span class="fl">-1.1952077</span></a>
<a class="sourceLine" id="cb8-46" title="46">[<span class="dv">38</span>;<span class="dv">5</span>;248m3   [39m  <span class="fl">0.72698623</span>  <span class="fl">0.90151250</span> <span class="fl">-0.3221795</span>  <span class="fl">1.5324095</span></a>
<a class="sourceLine" id="cb8-47" title="47">[<span class="dv">38</span>;<span class="dv">5</span>;248m4   [39m  <span class="fl">0.99975258</span> <span class="fl">-0.00375520</span> <span class="fl">-1.3356320</span> <span class="fl">-1.0536230</span></a>
<a class="sourceLine" id="cb8-48" title="48">[<span class="dv">38</span>;<span class="dv">5</span>;248m5   [39m <span class="fl">-0.74018300</span> <span class="fl">-0.62661678</span> <span class="fl">-0.5781103</span> <span class="fl">-0.3572723</span></a>
<a class="sourceLine" id="cb8-49" title="49">[<span class="dv">38</span>;<span class="dv">5</span>;248m<span class="op">--</span><span class="st">            </span><span class="op">--</span><span class="st">          </span><span class="op">--</span><span class="st">         </span><span class="op">--</span><span class="st">         </span><span class="op">--</span>[39m</a>
<a class="sourceLine" id="cb8-50" title="50">[<span class="dv">38</span>;<span class="dv">5</span>;248m996 [39m  <span class="fl">0.33352399</span> <span class="fl">-1.12146783</span>  <span class="fl">1.7425679</span> <span class="fl">-0.6546841</span></a>
<a class="sourceLine" id="cb8-51" title="51">[<span class="dv">38</span>;<span class="dv">5</span>;248m997 [39m  <span class="fl">0.79218644</span>  <span class="fl">0.08180355</span>  <span class="fl">0.3585000</span>  <span class="fl">0.4762698</span></a>
<a class="sourceLine" id="cb8-52" title="52">[<span class="dv">38</span>;<span class="dv">5</span>;248m998 [39m <span class="fl">-1.99171221</span> <span class="fl">-1.19306231</span>  <span class="fl">0.7714435</span>  <span class="fl">1.6982477</span></a>
<a class="sourceLine" id="cb8-53" title="53">[<span class="dv">38</span>;<span class="dv">5</span>;248m999 [39m <span class="fl">-1.00767350</span> <span class="fl">-0.71490699</span> <span class="fl">-0.2323266</span> <span class="fl">-0.1628912</span></a>
<a class="sourceLine" id="cb8-54" title="54">[<span class="dv">38</span>;<span class="dv">5</span>;248m1000[39m  <span class="fl">0.31564474</span> <span class="fl">-0.75080150</span> <span class="fl">-1.9592987</span> <span class="fl">-1.1726563</span></a>
<a class="sourceLine" id="cb8-55" title="55"></a>
<a class="sourceLine" id="cb8-56" title="56"><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb8-57" title="57">[<span class="dv">1</span>] <span class="st">"niifst_table"</span></a>
<a class="sourceLine" id="cb8-58" title="58">[<span class="dv">1</span>] <span class="st">"indices"</span> <span class="st">"data"</span>   </a></code></pre></div>
</div>
<div id="reading-in-all-the-files-1" class="section level3">
<h3 class="hasAnchor">
<a href="#reading-in-all-the-files-1" class="anchor"></a>Reading in all the files</h3>
<p>We showed that we can read in one of the files. Now, let’s read in all the files. This code checks to make sure the dimensions of the images are the same (but no orientation or other checks):</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="cf">if</span> (run) {</a>
<a class="sourceLine" id="cb9-2" title="2">  res =<span class="st"> </span><span class="kw"><a href="../reference/nii2fst.html">nii2fst</a></span>(files_4d, <span class="dt">read_in =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb9-3" title="3">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(res<span class="op">$</span>indices)</a>
<a class="sourceLine" id="cb9-4" title="4">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(res<span class="op">$</span>data))</a>
<a class="sourceLine" id="cb9-5" title="5">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/dim">dim</a></span>(res<span class="op">$</span>data[[<span class="dv">1</span>]]))</a>
<a class="sourceLine" id="cb9-6" title="6">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/class">class</a></span>(res))</a>
<a class="sourceLine" id="cb9-7" title="7">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(res))</a>
<a class="sourceLine" id="cb9-8" title="8">}</a>
<a class="sourceLine" id="cb9-9" title="9"><span class="op">&lt;</span>fst file<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb9-10" title="10"><span class="dv">1000</span> rows, <span class="dv">3</span> <span class="kw">columns</span> (file16f1464c40c3f.fst)</a>
<a class="sourceLine" id="cb9-11" title="11"></a>
<a class="sourceLine" id="cb9-12" title="12">[<span class="dv">38</span>;<span class="dv">5</span>;248m    [39m      dim1      dim2      dim3</a>
<a class="sourceLine" id="cb9-13" title="13">[3m[<span class="dv">38</span>;<span class="dv">5</span>;248m     <span class="op">&lt;</span>integer<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>integer<span class="op">&gt;</span><span class="st"> </span><span class="er">&lt;</span>integer<span class="op">&gt;</span>[39m[23m</a>
<a class="sourceLine" id="cb9-14" title="14">[<span class="dv">38</span>;<span class="dv">5</span>;248m1   [39m         <span class="dv">1</span>         <span class="dv">1</span>         <span class="dv">1</span></a>
<a class="sourceLine" id="cb9-15" title="15">[<span class="dv">38</span>;<span class="dv">5</span>;248m2   [39m         <span class="dv">2</span>         <span class="dv">1</span>         <span class="dv">1</span></a>
<a class="sourceLine" id="cb9-16" title="16">[<span class="dv">38</span>;<span class="dv">5</span>;248m3   [39m         <span class="dv">3</span>         <span class="dv">1</span>         <span class="dv">1</span></a>
<a class="sourceLine" id="cb9-17" title="17">[<span class="dv">38</span>;<span class="dv">5</span>;248m4   [39m         <span class="dv">4</span>         <span class="dv">1</span>         <span class="dv">1</span></a>
<a class="sourceLine" id="cb9-18" title="18">[<span class="dv">38</span>;<span class="dv">5</span>;248m5   [39m         <span class="dv">5</span>         <span class="dv">1</span>         <span class="dv">1</span></a>
<a class="sourceLine" id="cb9-19" title="19">[<span class="dv">38</span>;<span class="dv">5</span>;248m<span class="op">--</span><span class="st">          </span><span class="op">--</span><span class="st">        </span><span class="op">--</span><span class="st">        </span><span class="op">--</span>[39m</a>
<a class="sourceLine" id="cb9-20" title="20">[<span class="dv">38</span>;<span class="dv">5</span>;248m996 [39m         <span class="dv">6</span>        <span class="dv">10</span>        <span class="dv">10</span></a>
<a class="sourceLine" id="cb9-21" title="21">[<span class="dv">38</span>;<span class="dv">5</span>;248m997 [39m         <span class="dv">7</span>        <span class="dv">10</span>        <span class="dv">10</span></a>
<a class="sourceLine" id="cb9-22" title="22">[<span class="dv">38</span>;<span class="dv">5</span>;248m998 [39m         <span class="dv">8</span>        <span class="dv">10</span>        <span class="dv">10</span></a>
<a class="sourceLine" id="cb9-23" title="23">[<span class="dv">38</span>;<span class="dv">5</span>;248m999 [39m         <span class="dv">9</span>        <span class="dv">10</span>        <span class="dv">10</span></a>
<a class="sourceLine" id="cb9-24" title="24">[<span class="dv">38</span>;<span class="dv">5</span>;248m1000[39m        <span class="dv">10</span>        <span class="dv">10</span>        <span class="dv">10</span></a>
<a class="sourceLine" id="cb9-25" title="25">[<span class="dv">1</span>] <span class="dv">4</span></a>
<a class="sourceLine" id="cb9-26" title="26">[<span class="dv">1</span>] <span class="dv">1000</span>   <span class="dv">10</span></a>
<a class="sourceLine" id="cb9-27" title="27">[<span class="dv">1</span>] <span class="st">"niifst_table"</span></a>
<a class="sourceLine" id="cb9-28" title="28">[<span class="dv">1</span>] <span class="st">"indices"</span> <span class="st">"data"</span>   </a></code></pre></div>
</div>
<div id="subsetting-the-data-1" class="section level3">
<h3 class="hasAnchor">
<a href="#subsetting-the-data-1" class="anchor"></a>Subsetting the data</h3>
<p>Let’s get some rows that we want from the data. Here, we will subset based on <code>indices</code>, but apply that subsetting to <code>data</code>. Note, as per <a href="https://github.com/fstpackage/fst/issues/108" class="uri">https://github.com/fstpackage/fst/issues/108</a>, there is a <code>dplyr</code> interface that may be in the works, but right now I’d recommend using base bracket subsetting.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="cf">if</span> (run) {</a>
<a class="sourceLine" id="cb10-2" title="2">  index =<span class="st"> </span>res<span class="op">$</span>indices</a>
<a class="sourceLine" id="cb10-3" title="3">  index =<span class="st"> </span>index<span class="op">$</span>dim1 <span class="op">==</span><span class="st"> </span><span class="dv">8</span> <span class="op">&amp;</span><span class="st"> </span>(index<span class="op">$</span>dim2 <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span> <span class="op">&amp;</span><span class="st"> </span>index<span class="op">$</span>dim2 <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>) <span class="op">&amp;</span><span class="st"> </span>(index<span class="op">$</span>dim3 <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span> <span class="op">&amp;</span><span class="st"> </span>index<span class="op">$</span>dim3 <span class="op">&lt;</span><span class="st"> </span><span class="dv">7</span>)</a>
<a class="sourceLine" id="cb10-4" title="4">  res<span class="op">$</span>data[[<span class="dv">1</span>]][index,]</a>
<a class="sourceLine" id="cb10-5" title="5">  mat =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">lapply</a></span>(res<span class="op">$</span>data, <span class="cf">function</span>(mat) mat[index, ]) </a>
<a class="sourceLine" id="cb10-6" title="6">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(mat))</a>
<a class="sourceLine" id="cb10-7" title="7">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/lapply">sapply</a></span>(mat, dim))</a>
<a class="sourceLine" id="cb10-8" title="8">  <span class="cf">if</span> (<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/ns-load">requireNamespace</a></span>(<span class="st">"abind"</span>, <span class="dt">quietly =</span> <span class="ot">TRUE</span>)) {</a>
<a class="sourceLine" id="cb10-9" title="9">    mat =<span class="st"> </span>abind<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/abind/topics/abind">abind</a></span>(mat, <span class="dt">along =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb10-10" title="10">    <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/dim">dim</a></span>(mat))</a>
<a class="sourceLine" id="cb10-11" title="11">  }</a>
<a class="sourceLine" id="cb10-12" title="12">}</a>
<a class="sourceLine" id="cb10-13" title="13">[<span class="dv">1</span>] <span class="dv">4</span></a>
<a class="sourceLine" id="cb10-14" title="14">     [,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb10-15" title="15">[<span class="dv">1</span>,]    <span class="dv">4</span>    <span class="dv">4</span>    <span class="dv">4</span>    <span class="dv">4</span></a>
<a class="sourceLine" id="cb10-16" title="16">[<span class="dv">2</span>,]   <span class="dv">10</span>   <span class="dv">10</span>   <span class="dv">10</span>   <span class="dv">10</span></a>
<a class="sourceLine" id="cb10-17" title="17">[<span class="dv">1</span>]  <span class="dv">4</span> <span class="dv">10</span>  <span class="dv">4</span></a></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#use-case">Use case</a><ul class="nav nav-pills nav-stacked">
<li><a href="#d-example">3D Example</a></li>
      <li><a href="#d-example-1">4D Example</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by John Muschelli, Alessandra Valcarcel.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
